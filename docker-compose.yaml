version: "3.3"

services:
  prod:
    build: .
    volumes:
      - ./_site:/_site
    command: "yarn build-prod"
    depends_on:
      - build-css-prod

  site:
    build: .
    volumes:
      - ./project:/project
      - ./_site:/_site
    ports:
      - "8080:8080"
    command: "yarn dev-serve"
    depends_on:
      - build-css

  build-css:
    build: .
    volumes:
      - ./project:/project
      - ./_site:/_site
    command: "yarn build-css-dev"

  build-css-prod:
    build: .
    volumes:
      - ./_site:/_site
    command: "yarn build-css-prod"
